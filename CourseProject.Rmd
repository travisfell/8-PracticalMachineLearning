---
title: "Classe Prediction"
author: "Travis Fell"
date: "September 24, 2015"
output: html_document
---
#I. Introduction
This analysis sets out to answer the question posed by the assignment: what are the predictors of a correctly executed barbell lift. 

#II. Set Up Work
First, we'll start out by loading libraries, loading data and doing a bit of exploratory analysis. 
```{r}
library(caret)
library(ggplot2)
library(dplyr)
train <- read.csv("pml-training.csv", stringsAsFactors = FALSE, na.strings=c("", "NA"))
test <- read.csv("pml-testing.csv", stringsAsFactors = FALSE, na.strings=c("", "NA"))
str(train)
summary(train)
View(train)
colnames(train)
View(test)
table(train$classe)
count(train, classe)

```
Notably, in the train data set, about 25% of the records indicate a correctly done exercise. Also, there are a large number of columns with NA in almost all records. So, we are going to remove those for this analysis.

```{r}
# filter out columns with majority NA values
train <- train[sapply(train, function(x) !any(is.na(x)))] 
test <- test[sapply(test, function(x) !any(is.na(x)))]
```

#III. Predicting Results
Now we will set about constructing our model. 


## A. Cross Validation and Out of Sample Error



## B. Selecting Predictors
Because there are nearly 60 different variables in this data, we will do some preprocessing with principal components analysis to find and combine like variables. 
```{r}
M <- abs(cor(train[,8:59])) # find correlation b/t all variables except record number, user_name, timestamp columns and classe column
diag(M) <- 0
pred <- which(M >.8, arr.ind = TRUE)
highCorVar <- unique(pred[,2])
highCorVar <- highCorVar + 7

trainPred <- train[,highCorVar]

plot(train$total_accel_belt, train$total_accel_dumbbell)

```

Building the Model

```{r}
modelTrain <- train[,8:60]
modelFit <- train(modelTrain$classe ~ ., method = "glm", preProcess = "pca", data = modelTrain)
```

Making Predictions




This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
